# Base aggregation

### Calculate the total amount of all issued penalties – use SUM to aggregate the penalty amounts
```sql
SELECT SUM(amount) AS total_penalty_amount
FROM penalty;
```

### Determine the average mileage recorded during maintenance – use AVG to calculate the mean value of mileage
```sql
SELECT AVG(mileage) AS average_maintenance_mileage
FROM maintenance;
```

### Count the number of payments for each status category – use GROUP BY to organize by status and COUNT to tally records
```sql
SELECT status, COUNT(*) AS payment_count
FROM payment
GROUP BY status;
```


### Find the longest trip distance recorded for each specific vehicle – use MAX to retrieve the highest distance value per vehicle group
```sql
SELECT vehicle_id, MAX(distance) AS max_trip_distance
FROM trip
GROUP BY vehicle_id;
```

### Find all booking prices with deposit more then 1000
```sql
SELECT booking_price, COUNT(*) AS tariff_count
FROM tariff
WHERE deposit > 1000
GROUP BY booking_price;
```

### Find the lowest price per minute among all available tariffs – use MIN to select the smallest price value
```sql
SELECT MIN(price_per_minute) AS min_tariff_price
FROM tariff;
```

# Groups filtering

### Identify users who have spent a total of over 2000 on paid transactions – use WHERE to filter valid payments and HAVING to filter the total sum
```sql
SELECT user_id, SUM(amount) AS total_spent
FROM payment
WHERE status = 'paid'
GROUP BY user_id
HAVING SUM(amount) > 2000;
```

### Find vehicles that have been used frequently – use GROUP BY to organize by vehicle and HAVING to filter for 3 or more trips
```sql
SELECT vehicle_id, COUNT(*) AS trip_count
FROM trip
GROUP BY vehicle_id
HAVING COUNT(*) >= 3;
```

### Determine which vehicle brands have low average fuel levels – use AVG to calculate the mean and HAVING to filter for levels below 50
```sql
SELECT brand, AVG(fuel_level) AS average_fuel
FROM vehicle
GROUP BY brand
HAVING AVG(fuel_level) < 50;
```

### List maintenance types that occur repeatedly – use COUNT to tally occurrences and HAVING to show types appearing more than once
```sql
SELECT type, COUNT(*) AS frequency
FROM maintenance
GROUP BY type
HAVING COUNT(*) > 1;
```

### Identify users who typically drive long distances – use AVG to find the mean distance and HAVING to filter for averages exceeding 10
```sql
SELECT user_id, AVG(distance) AS avg_distance
FROM trip
GROUP BY user_id
HAVING AVG(distance) > 10;
```

### Find users with a history of multiple cancelled bookings – use WHERE to filter for cancellations and HAVING to identify users with more than one such record
```sql
SELECT user_id, COUNT(*) AS cancelled_count
FROM booking
WHERE status = 'cancelled'
GROUP BY user_id
HAVING COUNT(*) > 1;
```

# Grouping

### Count the total number of vehicles for each manufacturer – use GROUP BY to categorize by brand
```sql
SELECT brand, COUNT(*) AS vehicle_count
FROM vehicle
GROUP BY brand;
```

### Calculate the average mileage recorded for each specific maintenance type – use AVG to determine the mean value per type
```sql
SELECT type, AVG(mileage) AS avg_maintenance_mileage
FROM maintenance
GROUP BY type;
```

### Calculate the total distance traveled and total revenue generated by each vehicle – use SUM to aggregate both distance and cost
```sql
SELECT 
    vehicle_id, 
    SUM(distance) AS total_distance, 
    SUM(cost) AS total_earnings
FROM trip
GROUP BY vehicle_id;
```

### Determine the distribution of bookings across different statuses – use COUNT to tally bookings per status category
```sql
SELECT status, COUNT(*) AS booking_count
FROM booking
GROUP BY status;
```

### Analyze user growth by counting new registrations per year - use EXTRACT to isolate the year and ORDER BY to sort chronologically
```sql
SELECT 
    EXTRACT(YEAR FROM registration_date) AS registration_year, 
    COUNT(*) AS new_users
FROM users
GROUP BY EXTRACT(YEAR FROM registration_date)
ORDER BY registration_year;
```

# JOIN queries

### Retrieve detailed penalty information linking the user, the trip, and the specific vehicle involved – use INNER JOIN to connect data across four tables
```sql
SELECT 
    u.last_name, 
    p.amount, 
    p.type AS penalty_reason, 
    v.plate_number
FROM penalty p
INNER JOIN users u ON p.user_id = u.user_id
INNER JOIN trip t ON p.trip_id = t.trip_id
INNER JOIN vehicle v ON t.vehicle_id = v.vehicle_id;
```

### List all registered users along with their booking history – use LEFT JOIN to include users who have not made any bookings yet
```sql
SELECT 
    u.first_name, 
    u.last_name, 
    b.booking_id, 
    b.start_time
FROM users u
LEFT JOIN booking b ON u.user_id = b.user_id;
```

### Display vehicles alongside their associated pricing plans – use JOIN to link vehicles with their specific tariff details
```sql
SELECT 
    v.brand, 
    v.model, 
    t.name AS tariff_name, 
    t.price_per_minute
FROM vehicle v
JOIN tariff t ON v.tariff_id = t.tariff_id;
```

### Match trips with their corresponding payment transactions – use JOIN to combine trip data with payment methods and amounts
```sql
SELECT 
    t.trip_id, 
    t.distance, 
    p.amount, 
    p.method
FROM trip t
JOIN payment p ON t.trip_id = p.trip_id;
```

### Get the precise GPS location for each vehicle – use JOIN to retrieve latitude and longitude from the coordinates table
```sql
SELECT 
    v.plate_number, 
    c.latitude, 
    c.longitude
FROM vehicle v
JOIN coordinates c ON v.location = c.coordinates_id;
```

### List all maintenance records with the associated vehicle details – use RIGHT JOIN to ensure every maintenance log is shown
```sql
SELECT 
    v.brand, 
    m.date, 
    m.type, 
    m.comment
FROM vehicle v
RIGHT JOIN maintenance m ON v.vehicle_id = m.vehicle_id;
```

# Multi-table aggregation

### Rank vehicles by financial performance – use JOIN to connect vehicles with trips and SUM to calculate total revenue generated per model
```sql
SELECT 
    v.brand, 
    v.model, 
    SUM(t.cost) AS total_revenue
FROM vehicle v
JOIN trip t ON v.vehicle_id = t.vehicle_id
GROUP BY v.brand, v.model
ORDER BY total_revenue DESC;
```

### Calculate the total expenditure for each user – use WHERE to filter for successful payments and GROUP BY to aggregate costs per individual
```sql
SELECT 
    u.first_name, 
    u.last_name, 
    SUM(p.amount) AS total_spent
FROM users u
JOIN payment p ON u.user_id = p.user_id
WHERE p.status = 'paid'
GROUP BY u.user_id, u.first_name, u.last_name;
```

### Determine the average cost of a trip for each pricing plan – use multiple JOINS to link trips to tariffs and AVG to find the mean cost
```sql
SELECT 
    tr.name AS tariff_name, 
    AVG(t.cost) AS average_trip_cost
FROM trip t
JOIN vehicle v ON t.vehicle_id = v.vehicle_id
JOIN tariff tr ON v.tariff_id = tr.tariff_id
GROUP BY tr.name;
```

### Analyze penalties associated with different car manufacturers – use SUM to aggregate penalty amounts grouped by vehicle brand
```sql
SELECT 
    v.brand, 
    SUM(p.amount) AS total_penalty_amount
FROM penalty p
JOIN trip t ON p.trip_id = t.trip_id
JOIN vehicle v ON t.vehicle_id = v.vehicle_id
GROUP BY v.brand;
```

### Identify the most active drivers based on distance – use SUM to calculate total kilometers and ORDER BY to rank users from highest to lowest
```sql
SELECT 
    u.email, 
    SUM(t.distance) AS total_kilometers
FROM users u
JOIN trip t ON u.user_id = t.user_id
GROUP BY u.email
ORDER BY total_kilometers DESC;
```

### Assess the popularity of different tariffs based on booking frequency – use COUNT to tally bookings associated with each tariff plan
```sql
SELECT 
    tr.name AS tariff_name, 
    COUNT(b.booking_id) AS total_bookings
FROM booking b
JOIN vehicle v ON b.vehicle_id = v.vehicle_id
JOIN tariff tr ON v.tariff_id = tr.tariff_id
GROUP BY tr.name;
```
